<mujoco model="chassis">
    <compiler angle="radian"/>

    <default>
        <joint damping="0.1" armature="0.01"/>
        <geom friction="1.2 0.005 0.0001" condim="3"/>

        <default class="rail_ext">
            <joint damping="20.0" armature="0.1"/>
        </default>

        <default class="wheel_ext">
            <joint damping="0.05" armature="0.01"/>
        </default>
    </default>

    <asset>
        <mesh name="base_link" file="../robots/costume_R2/meshes/base_link.stl"/>
        <mesh name="LF_rail_link" file="../robots/costume_R2/meshes/LF_rail_link.stl"/>
        <mesh name="LF_yaw_link" file="../robots/costume_R2/meshes/LF_yaw_link.stl"/>
        <mesh name="LF_wheel_link" file="../robots/costume_R2/meshes/LF_wheel_link.stl"/>
        <mesh name="LR_rail_link" file="../robots/costume_R2/meshes/LR_rail_link.stl"/>
        <mesh name="LR_yaw_link" file="../robots/costume_R2/meshes/LR_yaw_link.stl"/>
        <mesh name="LR_wheel_link" file="../robots/costume_R2/meshes/LR_wheel_link.stl"/>
        <mesh name="RF_rail_link" file="../robots/costume_R2/meshes/RF_rail_link.stl"/>
        <mesh name="RF_yaw_link" file="../robots/costume_R2/meshes/RF_yaw_link.stl"/>
        <mesh name="RF_wheel_link" file="../robots/costume_R2/meshes/RF_wheel_link.stl"/>
        <mesh name="RR_rail_link" file="../robots/costume_R2/meshes/RR_rail_link.stl"/>
        <mesh name="RR_yaw_link" file="../robots/costume_R2/meshes/RR_yaw_link.stl"/>
        <mesh name="RR_wheel_link" file="../robots/costume_R2/meshes/RR_wheel_link.stl"/>
    </asset>

    <worldbody>
        <body name="base_link" pos="0 0 0.5">
            <freejoint name="floating_base"/> 
            <site name="imu_site" pos="0.0012 -0.3534 0.017" size="0.01" rgba=" 0 0 1 1"/>

            <body name="front_rgb_camera_link" pos="0 -0.72 0.10">
                <geom type="sphere" size="0.01" rgba="0 0.6 1 0.35" contype="0" conaffinity="0"/>
                <camera name="rgb_camera" pos="0 0.43 0" xyaxes="1 0 0 0 0 1" fovy="70" resolution="640 480"/>
            </body>
            <inertial pos="0.001206 -0.353411 0.016987" mass="2.804" diaginertia="0.015653 0.013748 0.027267"/>
            
            <geom type="mesh" rgba="1 1 1 0.2" mesh="base_link" contype="1" conaffinity="1" group="1"/>

            <geom type="box" size="0.02 0.3 0.02" pos="0.3 -0.354 0" rgba="1 0 0 0.6" contype="0" conaffinity="0"/>
            <geom type="box" size="0.02 0.3 0.02" pos="-0.3 -0.354 0" rgba="1 0 0 0.6" contype="0" conaffinity="0"/>
            <geom type="box" size="0.3 0.02 0.02" pos="0 -0.654 0" rgba="1 0 0 0.6" contype="0" conaffinity="0"/>
            <geom type="box" size="0.3 0.02 0.02" pos="0 -0.054 0" rgba="1 0 0 0.6" contype="0" conaffinity="0"/>
            <geom type="box" size="0.42 0.02 0.02" pos="0 -0.354 0" quat="0.9239 0 0 0.3827" rgba="1 0 0 0.6" contype="0" conaffinity="0"/>
            <geom type="box" size="0.42 0.02 0.02" pos="0 -0.354 0" quat="0.9239 0 0 -0.3827" rgba="1 0 0 0.6" contype="0" conaffinity="0"/>

            <body name="LF_passive_wheel_L" pos="0.39856 -0.72219 -0.10" quat="0.707106 0 0.707106 0">
                <joint name="LF_passive_wheel_L_joint" type="hinge" axis="0 0 1" limited="false" damping="0.01" frictionloss="0"/>
                <geom name="LF_passive_wheel_L_geom" type="cylinder" size="0.02 0.006"
                    contype="1" conaffinity="1" condim="3"
                    friction="0.4 0.005 0.0001" solref="0.02 1" solimp="0.9 0.95 0.001"
                    rgba="1 1 1 1" group="3"/>
            </body>
            <body name="LF_passive_wheel_R" pos="0.21476 -0.59503 -0.10" quat="0.707106 0 0.707106 0">
                <joint name="LF_passive_wheel_R_joint" type="hinge" axis="0 0 1" limited="false" damping="0.01" frictionloss="0"/>
                <geom name="LF_passive_wheel_R_geom" type="cylinder" size="0.02 0.006"
                    contype="1" conaffinity="1" condim="3"
                    friction="0.4 0.005 0.0001" solref="0.02 1" solimp="0.9 0.95 0.001"
                    rgba="1 1 1 1" group="3"/>
            </body>

            <body name="RF_passive_wheel_L" pos="-0.21069 -0.59502 -0.10" quat="0.707106 0 0.707106 0">
                <joint name="RF_passive_wheel_L_joint" type="hinge" axis="0 0 1" limited="false" damping="0.01" frictionloss="0"/>
                <geom name="RF_passive_wheel_L_geom" type="cylinder" size="0.02 0.006"
                    contype="1" conaffinity="1" condim="3"
                    friction="0.4 0.005 0.0001" solref="0.02 1" solimp="0.9 0.95 0.001"
                    rgba="1 1 1 1" group="3"/>
            </body>
            <body name="RF_passive_wheel_R" pos="-0.39461 -0.72238 -0.10" quat="0.707106 0 0.707106 0">
                <joint name="RF_passive_wheel_R_joint" type="hinge" axis="0 0 1" limited="false" damping="0.01" frictionloss="0"/>
                <geom name="RF_passive_wheel_R_geom" type="cylinder" size="0.02 0.006"
                    contype="1" conaffinity="1" condim="3"
                    friction="0.4 0.005 0.0001" solref="0.02 1" solimp="0.9 0.95 0.001"
                    rgba="1 1 1 1" group="3"/>
            </body>

            <body name="LR_passive_wheel_L" pos="0.21476 -0.11297 -0.10" quat="0.707106 0 0.707106 0">
                <joint name="LR_passive_wheel_L_joint" type="hinge" axis="0 0 1" limited="false" damping="0.01" frictionloss="0"/>
                <geom name="LR_passive_wheel_L_geom" type="cylinder" size="0.02 0.006"
                    contype="1" conaffinity="1" condim="3"
                    friction="0.4 0.005 0.0001" solref="0.02 1" solimp="0.9 0.95 0.001"
                    rgba="1 1 1 1" group="3"/>
            </body>
            <body name="LR_passive_wheel_R" pos="0.39856 0.01419 -0.10" quat="0.707106 0 0.707106 0">
                <joint name="LR_passive_wheel_R_joint" type="hinge" axis="0 0 1" limited="false" damping="0.01" frictionloss="0"/>
                <geom name="LR_passive_wheel_R_geom" type="cylinder" size="0.02 0.006"
                    contype="1" conaffinity="1" condim="3"
                    friction="0.4 0.005 0.0001" solref="0.02 1" solimp="0.9 0.95 0.001"
                    rgba="1 1 1 1" group="3"/>
            </body>

            <body name="RR_passive_wheel_L" pos="-0.39461 0.01438 -0.10" quat="0.707106 0 0.707106 0">
                <joint name="RR_passive_wheel_L_joint" type="hinge" axis="0 0 1" limited="false" damping="0.01" frictionloss="0"/>
                <geom name="RR_passive_wheel_L_geom" type="cylinder" size="0.02 0.006"
                    contype="1" conaffinity="1" condim="3"
                    friction="0.4 0.005 0.0001" solref="0.02 1" solimp="0.9 0.95 0.001"
                    rgba="1 1 1 1" group="3"/>
            </body>
            <body name="RR_passive_wheel_R" pos="-0.21069 -0.11298 -0.10" quat="0.707106 0 0.707106 0">
                <joint name="RR_passive_wheel_R_joint" type="hinge" axis="0 0 1" limited="false" damping="0.01" frictionloss="0"/>
                <geom name="RR_passive_wheel_R_geom" type="cylinder" size="0.02 0.006"
                    contype="1" conaffinity="1" condim="3"
                    friction="0.4 0.005 0.0001" solref="0.02 1" solimp="0.9 0.95 0.001"
                    rgba="1 1 1 1" group="3"/>
            </body>

            <body name="LF_rail_link" pos="0.30193 -0.654 0.33384" quat="0.707105 0 0 -0.707108">
                <joint name="LF_rail_joint" class="rail_ext" type="slide" axis="0 0 -1" range="0 0.25"/>
                <geom type="mesh" rgba="1 1 1 0.2" mesh="LF_rail_link" contype="0" conaffinity="0" group="1"/>
                <geom type="box" size="0.015 0.015 0.18" pos="0 0 -0.18" rgba="0 1 0 0.6"/>

                <body name="LF_yaw_link" pos="0 0 -0.3778">
                    <joint name="LF_yaw_joint" type="hinge" axis="0 0 1" limited="false"/>
                    <geom type="mesh" rgba="1 1 1 0.2" mesh="LF_yaw_link" contype="0" conaffinity="0" group="1"/>
                    
                    <geom type="cylinder" size="0.03 0.02" pos="0 0 0" rgba="0 0 1 0.6"/>

                    <body name="LF_wheel_link" pos="0 0 -0.0465" quat="0.65328 0.653282 -0.270599 -0.270598">
                        <joint name="LF_wheel_joint" class="wheel_ext" type="hinge" axis="0 0 -1" limited="false"/>
                        <geom size="0.03 0.016" type="cylinder" rgba="0.2 0.2 0.2 1" 
                            condim="3" 
                            friction="1.0 0.005 0.0001" 
                            solref="0.02 1" 
                            solimp="0.9 0.95 0.001"
                        />
                    </body>
                </body>
            </body>

            <body name="RF_rail_link" pos="-0.29807 -0.654 0.33384" quat="0.707105 0 0 -0.707108">
                <joint name="RF_rail_joint" class="rail_ext" type="slide" axis="0 0 -1" range="0 0.25"/>
                <geom type="mesh" rgba="1 1 1 0.2" mesh="RF_rail_link" contype="0" conaffinity="0" group="1"/>
                <geom type="box" size="0.015 0.015 0.18" pos="0 0 -0.18" rgba="0 1 0 0.6"/>

                <body name="RF_yaw_link" pos="0 0 -0.3778">
                    <joint name="RF_yaw_joint" type="hinge" axis="0 0 1" limited="false"/>
                    <geom type="mesh" rgba="1 1 1 0.2" mesh="RF_yaw_link" contype="0" conaffinity="0" group="1"/>
                    
                    <geom type="cylinder" size="0.03 0.02" pos="0 0 0" rgba="0 0 1 0.6"/>

                    <body name="RF_wheel_link" pos="0 0 -0.0465" quat="0.270596 0.270597 -0.653283 -0.653281">
                        <joint name="RF_wheel_joint" class="wheel_ext" type="hinge" axis="0 0 -1" limited="false"/>
                        <geom size="0.03 0.016" type="cylinder" rgba="0.2 0.2 0.2 1" 
                            condim="3" 
                            friction="1.0 0.005 0.0001" 
                            solref="0.02 1" 
                            solimp="0.9 0.95 0.001"
                        />
                    </body>
                </body>
            </body>

            <body name="LR_rail_link" pos="0.30193 -0.054 0.33384" quat="0.707105 0 0 -0.707108">
                <joint name="LR_rail_joint" class="rail_ext" type="slide" axis="0 0 -1" range="0 0.25"/>
                <geom type="mesh" rgba="1 1 1 0.2" mesh="LR_rail_link" contype="0" conaffinity="0" group="1"/>
                <geom type="box" size="0.015 0.015 0.18" pos="0 0 -0.18" rgba="0 1 0 0.6"/>

                <body name="LR_yaw_link" pos="0 0 -0.3778">
                    <joint name="LR_yaw_joint" type="hinge" axis="0 0 1" limited="false"/>
                    <geom type="mesh" rgba="1 1 1 0.2" mesh="LR_yaw_link" contype="0" conaffinity="0" group="1"/>
                    
                    <geom type="cylinder" size="0.03 0.02" pos="0 0 0" rgba="0 0 1 0.6"/>

                    <body name="LR_wheel_link" pos="0 0 -0.0465" quat="0.65328 0.653282 0.270599 0.270598">
                        <joint name="LR_wheel_joint" class="wheel_ext" type="hinge" axis="0 0 -1" limited="false"/>
                        <geom size="0.03 0.016" type="cylinder" rgba="0.2 0.2 0.2 1" 
                            condim="3" 
                            friction="1.0 0.005 0.0001" 
                            solref="0.02 1" 
                            solimp="0.9 0.95 0.001"
                        />
                    </body>
                </body>
            </body>

            <body name="RR_rail_link" pos="-0.29807 -0.054 0.33384" quat="0.707105 0 0 -0.707108">
                <joint name="RR_rail_joint" class="rail_ext" type="slide" axis="0 0 -1" range="0 0.25"/>
                <geom type="mesh" rgba="1 1 1 0.2" mesh="RR_rail_link" contype="0" conaffinity="0" group="1"/>
                <geom type="box" size="0.015 0.015 0.18" pos="0 0 -0.18" rgba="0 1 0 0.6"/>

                <body name="RR_yaw_link" pos="0 0 -0.3778">
                    <joint name="RR_yaw_joint" type="hinge" axis="0 0 1" limited="false"/>
                    <geom type="mesh" rgba="1 1 1 0.2" mesh="RR_yaw_link" contype="0" conaffinity="0" group="1"/>
                    
                    <geom type="cylinder" size="0.03 0.02" pos="0 0 0" rgba="0 0 1 0.6"/>

                    <body name="RR_wheel_link" pos="0 0 -0.0465" quat="0.270596 0.270597 0.653283 0.653281">
                        <joint name="RR_wheel_joint" class="wheel_ext" type="hinge" axis="0 0 -1" limited="false"/>
                        <geom size="0.03 0.016" type="cylinder" rgba="0.2 0.2 0.2 1" 
                            condim="3" 
                            friction="1.0 0.005 0.0001" 
                            solref="0.02 1" 
                            solimp="0.9 0.95 0.001"
                        />
                    </body>
                </body>
            </body>

        </body>
    </worldbody>

    <contact>
        <exclude body1="base_link" body2="LF_rail_link"/>
        <exclude body1="base_link" body2="RF_rail_link"/>
        <exclude body1="base_link" body2="LR_rail_link"/>
        <exclude body1="base_link" body2="RR_rail_link"/>

        <exclude body1="base_link" body2="LF_passive_wheel_L"/>
        <exclude body1="base_link" body2="LF_passive_wheel_R"/>
        <exclude body1="base_link" body2="RF_passive_wheel_L"/>
        <exclude body1="base_link" body2="RF_passive_wheel_R"/>
        <exclude body1="base_link" body2="LR_passive_wheel_L"/>
        <exclude body1="base_link" body2="LR_passive_wheel_R"/>
        <exclude body1="base_link" body2="RR_passive_wheel_L"/>
        <exclude body1="base_link" body2="RR_passive_wheel_R"/>

        <exclude body1="LF_passive_wheel_L" body2="LF_rail_link"/>
        <exclude body1="LF_passive_wheel_R" body2="LF_rail_link"/>
        <exclude body1="LF_passive_wheel_L" body2="LF_yaw_link"/>
        <exclude body1="LF_passive_wheel_R" body2="LF_yaw_link"/>
        <exclude body1="LF_passive_wheel_L" body2="LF_wheel_link"/>
        <exclude body1="LF_passive_wheel_R" body2="LF_wheel_link"/>

        <exclude body1="RF_passive_wheel_L" body2="RF_rail_link"/>
        <exclude body1="RF_passive_wheel_R" body2="RF_rail_link"/>
        <exclude body1="RF_passive_wheel_L" body2="RF_yaw_link"/>
        <exclude body1="RF_passive_wheel_R" body2="RF_yaw_link"/>
        <exclude body1="RF_passive_wheel_L" body2="RF_wheel_link"/>
        <exclude body1="RF_passive_wheel_R" body2="RF_wheel_link"/>

        <exclude body1="LR_passive_wheel_L" body2="LR_rail_link"/>
        <exclude body1="LR_passive_wheel_R" body2="LR_rail_link"/>
        <exclude body1="LR_passive_wheel_L" body2="LR_yaw_link"/>
        <exclude body1="LR_passive_wheel_R" body2="LR_yaw_link"/>
        <exclude body1="LR_passive_wheel_L" body2="LR_wheel_link"/>
        <exclude body1="LR_passive_wheel_R" body2="LR_wheel_link"/>

        <exclude body1="RR_passive_wheel_L" body2="RR_rail_link"/>
        <exclude body1="RR_passive_wheel_R" body2="RR_rail_link"/>
        <exclude body1="RR_passive_wheel_L" body2="RR_yaw_link"/>
        <exclude body1="RR_passive_wheel_R" body2="RR_yaw_link"/>
        <exclude body1="RR_passive_wheel_L" body2="RR_wheel_link"/>
        <exclude body1="RR_passive_wheel_R" body2="RR_wheel_link"/>

        <exclude body1="LF_rail_link" body2="LF_yaw_link"/>
        <exclude body1="RF_rail_link" body2="RF_yaw_link"/>
        <exclude body1="LR_rail_link" body2="LR_yaw_link"/>
        <exclude body1="RR_rail_link" body2="RR_yaw_link"/>

        <exclude body1="LF_yaw_link" body2="LF_wheel_link"/>
        <exclude body1="RF_yaw_link" body2="RF_wheel_link"/>
        <exclude body1="LR_yaw_link" body2="LR_wheel_link"/>
        <exclude body1="RR_yaw_link" body2="RR_wheel_link"/>
    </contact>

    <actuator>
        <position name="LF_steer" joint="LF_yaw_joint" kp="500" forcerange="-10.0 10.0" ctrlrange="-3.1416 3.1416"/>
        <position name="RF_steer" joint="RF_yaw_joint" kp="500" forcerange="-10.0 10.0" ctrlrange="-3.1416 3.1416"/>
        <position name="LR_steer" joint="LR_yaw_joint" kp="500" forcerange="-10.0 10.0" ctrlrange="-3.1416 3.1416"/>
        <position name="RR_steer" joint="RR_yaw_joint" kp="500" forcerange="-10.0 10.0" ctrlrange="-3.1416 3.1416"/>

        <velocity name="LF_drive" joint="LF_wheel_joint" kv="20" forcerange="-50.0 50.0" ctrlrange="-100 100"/>
        <velocity name="RF_drive" joint="RF_wheel_joint" kv="20" forcerange="-50.0 50.0" ctrlrange="-100 100"/>
        <velocity name="LR_drive" joint="LR_wheel_joint" kv="20" forcerange="-50.0 50.0" ctrlrange="-100 100"/>
        <velocity name="RR_drive" joint="RR_wheel_joint" kv="20" forcerange="-50.0 50.0" ctrlrange="-100 100"/>

        <position name="LF_rail" joint="LF_rail_joint" kp="1000" forcerange="-500 500" ctrlrange="0 0.25"/>
        <position name="RF_rail" joint="RF_rail_joint" kp="1000" forcerange="-500 500" ctrlrange="0 0.25"/>
        <position name="LR_rail" joint="LR_rail_joint" kp="1000" forcerange="-500 500" ctrlrange="0 0.25"/>
        <position name="RR_rail" joint="RR_rail_joint" kp="1000" forcerange="-500 500" ctrlrange="0 0.25"/>
    </actuator>

    <sensor>
        <accelerometer name="imu_acc" site="imu_site"/>
        <gyro name="imu_gyro" site="imu_site"/>

        <jointpos name="LF_steer_pos" joint="LF_yaw_joint"/>
        <jointpos name="RF_steer_pos" joint="RF_yaw_joint"/>
        <jointpos name="LR_steer_pos" joint="LR_yaw_joint"/>
        <jointpos name="RR_steer_pos" joint="RR_yaw_joint"/>

        <jointvel name="LF_drive_vel" joint="LF_wheel_joint"/>
        <jointvel name="RF_drive_vel" joint="RF_wheel_joint"/>
        <jointvel name="LR_drive_vel" joint="LR_wheel_joint"/>
        <jointvel name="RR_drive_vel" joint="RR_wheel_joint"/>

        <jointactuatorfrc name="LF_s_t" joint="LF_yaw_joint"/>
        <jointactuatorfrc name="RF_s_t" joint="RF_yaw_joint"/>
        <jointactuatorfrc name="LR_s_t" joint="LR_yaw_joint"/>
        <jointactuatorfrc name="RR_s_t" joint="RR_yaw_joint"/>
        <jointactuatorfrc name="LF_d_t" joint="LF_wheel_joint"/>
        <jointactuatorfrc name="RF_d_t" joint="RF_wheel_joint"/>
        <jointactuatorfrc name="LR_d_t" joint="LR_wheel_joint"/>
        <jointactuatorfrc name="RR_d_t" joint="RR_wheel_joint"/>
    </sensor>
</mujoco>